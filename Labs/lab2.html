<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Labs/lab2">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="icon" href="/OPS705/img/pwa/icon-512x512.png">
<link rel="manifest" href="/OPS705/manifest.json">
<meta name="theme-color" content="#DA291C">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#DA291C">
<link rel="apple-touch-icon" href="/OPS705/img/pwa/icon-192x192.png">
<link rel="mask-icon" href="/OPS705/img/pwa/icon-512x512.png" color="#DA291C">
<meta name="msapplication-TileImage" content="/OPS705/img/pwa/icon-512x512.png">
<meta name="msapplication-TileColor" content="#DA291C">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Lab 2 | OPS705 - Introduction to Cloud Computing</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://Seneca-ICTOER.github.io//OPS705/Labs/lab2"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 2 | OPS705 - Introduction to Cloud Computing"><meta data-rh="true" name="description" content="Lab 2 - Securing Your Virtual Machines"><meta data-rh="true" property="og:description" content="Lab 2 - Securing Your Virtual Machines"><link data-rh="true" rel="icon" href="/OPS705/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://Seneca-ICTOER.github.io//OPS705/Labs/lab2"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OPS705/Labs/lab2" hreflang="en"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//OPS705/Labs/lab2" hreflang="x-default"><link rel="stylesheet" href="/OPS705/assets/css/styles.099fe1a9.css">
<link rel="preload" href="/OPS705/assets/js/runtime~main.bfe77d86.js" as="script">
<link rel="preload" href="/OPS705/assets/js/main.df20ef37.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/OPS705/"><div class="navbar__logo"><img src="/OPS705/img/logo.svg" alt="Seneca College" class="themedImage_ToTc themedImage--light_HNdA"><img src="/OPS705/img/logo-dark.svg" alt="Seneca College" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">OPS705 - Introduction to Cloud Computing</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OPS705/">Welcome to OPS705</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/OPS705/weekly-schedule">Weekly Schedule</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/OPS705/Labs/lab1">Labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS705/Labs/lab1">Lab 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/OPS705/Labs/lab2">Lab 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS705/Labs/lab3">Lab 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/OPS705/Labs/lab4">Lab 4</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/OPS705/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Labs</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 2</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 2: Securing Your Virtual Machines</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-preparation">Lab Preparation<a class="hash-link" href="#lab-preparation" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="purpose--objectives-of-lab-2">Purpose / Objectives of Lab 2<a class="hash-link" href="#purpose--objectives-of-lab-2" title="Direct link to heading">​</a></h3><p>In this lab, you will conduct several Linux system administration tasks to secure your system against would-be attackers and gain preliminary experience with the command line interface.</p><p>If you encounter technical issues, please contact your professor via e-mail or in your section&#x27;s Microsoft Teams group.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="minimum-requirements">Minimum Requirements<a class="hash-link" href="#minimum-requirements" title="Direct link to heading">​</a></h3><p>Before beginning, you must have: </p><ol><li>Successfully completed Lab 1.</li><li>Attended the Week 2 lecture</li><li>Read through the Week 2 slides, and have them handy as a reference for concepts</li><li>Your Seneca Azure login credentials</li><li>Your linked mobile device for 2FA</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-concepts">Key Concepts<a class="hash-link" href="#key-concepts" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="security-from-the-beginning">Security: From the Beginning<a class="hash-link" href="#security-from-the-beginning" title="Direct link to heading">​</a></h3><p>In the not-too-distant past, companies would focus on getting their product and systems working and relegating security as their last step, often as an afterthought. When security is only considered at the end of a project, it&#x27;s very difficult to remember all the ways in which your product interacts and things can get missed.</p><p>This created several high-profile breaches in the 90s and early 2000s, and our approach to security had to be reconsidered.</p><p>As a result, we now consider security <strong>from the beginning</strong>. As you create applications, add users to databases, create links between services, you <em>must</em> keep security in mind at every step of development. Securing as you go is the best method, but even something as simple as simply documenting unsecured parts of your code as you go can be enough (assuming you go back and fix them!)</p><p>Generally, we apply the concept of <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege" target="_blank" rel="noopener noreferrer">Principle of Least Privilege</a> to security. Essentially, this boils down to locking everything down as much as possible and only allowing what and who you need through. Open access makes you a target. You&#x27;ll be applying this principle to the firewall later in this lab.</p><p>We also take a look at defaults. Most systems and software come with pre-configured defaults to make out-of-the-box setup easy. This can take the form of a default username and password, default ports, etc. In a well secured system, these are often changed to avoid hack attempts. If you know the default, there&#x27;s a high chance that hackers know it as well. You&#x27;ll be changing some defaults in this lab.</p><p>This is not an exhaustive list of applied security, but it does give use a bit of working knowledge. You&#x27;ll need it for this lab as well as in our AWS work.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="firewalls">Firewalls<a class="hash-link" href="#firewalls" title="Direct link to heading">​</a></h3><p>In short, a firewall is a utility that sits on your computer between your network connection and the rest of your system.</p><p>Any application, services, or other data that is sent or received by your computer goes through your firewall first. The dominant network protocol is TCP/IP, which means we’re dealing with packets. A firewall looks at these packets. To be clear, the firewall doesn’t look inside packets, but just at the outside data like IP address and/or port destination, etc. The actual transmitted data is still secure and unread.</p><p>Generally with firewalls, we apply the <em>Principle of Least Privilege</em> by dropping all new connections by default, and allowing a few exceptions. This is known as <strong>whitelisting</strong>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-keypair-authentication">SSH Keypair Authentication<a class="hash-link" href="#ssh-keypair-authentication" title="Direct link to heading">​</a></h3><p>When you connect to a computer with an SSH server, you’re presented with a login screen. You are prompted for your username and password, and then allowed access if your credentials are correct. However, if your username and password are stolen (or guessed), someone else impersonating you can login. How do we prevent this?</p><p>We use <strong>public</strong> and <strong>private</strong> keys to make users prove who they say they are.</p><p>This is known as public-key cryptography.</p><p>On your client machine, we generate a public/private key pair. Using cryptography, this method creates a public key and a private key. The public key is used to encrypt messages, and only the private key can decode them. We can then install the public key on our SSH server. This public key is used to uniquely identify your specific user on your specific client computer. With this method, you log in to the SSH server, the keys calculate your identity transparently, and you are logged on without having to provide a password.</p><ul><li>Think of the public key like a lock you&#x27;re installing on a door. Everyone can see this lock, it&#x27;s public. But they can&#x27;t open it.</li><li>Your private key is exactly that: a key. It&#x27;s what&#x27;s used to open that lock.</li><li>By installing your public key on your Linux VM, you are creating a secure lock that only you can open with your key.</li></ul><p>You&#x27;ll create and install keys in this lab and later in our AWS labs as your only method to access those AWS VMs.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="editing-text-files">Editing Text Files<a class="hash-link" href="#editing-text-files" title="Direct link to heading">​</a></h3><p>As you will be working in the Linux command line environment, it is useful to learn a least one common command-line text editors.</p><p>Although programmers and developers usually use graphical IDE&#x27;s to code and compile programs (Visual Studio, Sublime, Eclipse, etc), they can create source code using a text editor and compile their code directly on the server to generate executable programs (without having to transfer them for compilation or execution).</p><p>Developers very often use a text editor to modify configuration files. In this course, you will become familiar with the process of installing, configuring, and running network services. Text editors are an important tool to help this setup, but are also used to &quot;tweak&quot; or make periodic changes in service configurations.</p><p>The two most readily-available command line text editors in Linux are <strong>nano</strong> and <strong>vi</strong>.</p><p>The nano text editor would seem like an easier-to-use text editor, but vi (although taking longer to learn) has outstanding features and allow the user to be more productive with editing text files.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-1--update-linux">Investigation 1:  Update Linux<a class="hash-link" href="#investigation-1--update-linux" title="Direct link to heading">​</a></h2><p>This investigation simply has you update your CentOS installation. This includes operating system packages, as well as any other packages that have been installed using yum.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-1-privilege-escalation">Part 1: Privilege Escalation<a class="hash-link" href="#part-1-privilege-escalation" title="Direct link to heading">​</a></h3><p>Updating the operating system, by its very nature, changes the system. <strong>Any command or utility that performs system-wide changes can only be run by a system administrator.</strong> Remember that.</p><p>To update the operating system, you&#x27;ll need to have administrative access. There are two ways to do this:</p><ol><li>logging in to an admin account from your regular account</li><li>running a command as your regular user with temporary admin powers</li></ol><p>We call this <em>privilege elevation</em> or <em>elevating your privileges</em>. Only regular user accounts that belong to the system&#x27;s administrator group can do this. The name of the admin group changes depending on the distribution of Linux; for CentOS, it&#x27;s the <strong>wheel</strong> group. The first user account you created as part of your VM installation was automatically added to this group as part of the Azure VM deployment process.</p><p>Let&#x27;s go through a few examples.</p><p>First, let&#x27;s login:</p><ol><li>Start your Linux VM in Azure (this may take a few minutes)</li><li>Connect to the VM remotely via SSH using your regular account. (Refer to Lab 1)</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-sudo">Using Sudo<a class="hash-link" href="#using-sudo" title="Direct link to heading">​</a></h4><p>We can run administration-level commands by using <strong>sudo</strong>. Sudo allows you to run a command as an administrator (root) from your standard account. For the duration of the command&#x27;s run, you are root. When the command completes, you are back to being a regular user.</p><p>Normally, the shell environment will ask you for your account password as an extra security precaution when using sudo. However, cloud-based Linux VMs typically have <em>password-less sudo access</em>. The idea is that identity management and security is handled by the cloud infrastructure. We&#x27;ll explore that in detail later in the course.</p><p>(Image:Ops705_lab2_fig1.png - Figure 1: Example commands with sudo.)</p><p>Run the following commands:</p><ol><li><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">whoami</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">whoami</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">whoami</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><p>The <em>whoami</em> command responds by printing out your username. Notice how, by using the command in combination with <em>sudo</em>, the response is <strong>root</strong>. While the second command is running, you are root. But the moment it ends, you drop back down to your standard user. This is why the third command responds with your standard user again.</p><p>Sudo is the preferred method of running admin-level commands, especially when you only have one command to run, or just a few. Only run commands with sudo that require it. Remember, the root user can do <strong>anything</strong> on the system, including accidentally delete all files. Only use it when you need it.</p><p>=== Logging Into Root ===
To run administration-level commands, we can also log into the root admin account from our standard user. This is primarily done when a user knows they&#x27;ll be running many admin-level commands during a session to complete a task.</p><p>From your standard user, elevate to the root account with the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">su</span><span class="token plain"> -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notice that your command prompt has immediately changed. It no longer prints out your username at the beginning of each line, but the name of the <strong>root</strong> account. This is a good visual aid to let you know how you&#x27;re logged in.</p><p>[<!-- -->[Image:Ops705_lab2_fig2.png|thumb|right|350px|Figure 2: Example commands as root.]<!-- -->]
Run the same commands from the sudo subsection:</p><ol><li><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">whoami</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">whoami</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">whoami</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><p>Notice that each command returns the output <strong>root</strong>. This is in contrast to using the sudo command from your regular user account. When you are logged into the root account directly as you are now, <strong>all commands you issue will run as root</strong>. Be very careful! With great power comes great responsibility.</p><p>To log out of root and drop back down to your regular user, run: <code>exit</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-2-update-centos">Part 2: Update CentOS<a class="hash-link" href="#part-2-update-centos" title="Direct link to heading">​</a></h3><p>As mentioned in the Week 2 lecture, keeping your Linux system up to date is an incredibly important task and must be done regularly. You are the administrator of this system, you must keep it running well. While updating is a graded part of this lab, you should run the command again regularly to check for new updates while you continue to work with this virtual machine over the next several weeks.</p><p>(Image:Ops705_lab2_fig3.png - Figure 3: A yum update in progress.)</p><p>Run the command to update CentOS:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> yum update</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Running this as a regular user will give you an error, which is why you temporarily elevate your privileges for the duration of a command with sudo.</p><p>There will likely be further user interaction for this update command, mostly asking you to confirm an action. For updates, you can type <code>y</code> and hit Enter safely. That said, do get in the habit of reading warnings and when it asks for your confirmation.</p><p>The update command will look for updates, download the install files, and then update the system. Most updates don&#x27;t require a restart (unlike Windows!), except for kernel updates. The kernel is the very basic building block of the system; sort of the heart. It&#x27;s responsible for many of the most basic functions a computer performs. If a kernel update is installed, you need to restart the system to use the new kernel. As this is your first update, you&#x27;ll likely have a kernel upgrade installed.</p><ul><li><p>When the yum update command completes, restart the system with the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">reboot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>You&#x27;ll be disconnected from your remote session as the SSH server inside your VM shuts down along with the rest of the system.</p><p>It may take a few minutes for the VM to restart. You can track its progress through the Azure DTL Overview page. Once back up and running, log back in to confirm everything still works.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-2-configuring-your-firewall">Investigation 2: Configuring Your Firewall<a class="hash-link" href="#investigation-2-configuring-your-firewall" title="Direct link to heading">​</a></h2><p>In this investigation, you&#x27;ll replace the default firewall with another and follow security best practices in constructing your firewall rules.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-1-replacing-firewalld-with-iptables">Part 1: Replacing <em>firewalld</em> with <em>iptables</em><a class="hash-link" href="#part-1-replacing-firewalld-with-iptables" title="Direct link to heading">​</a></h3><p>(Image:Ops705_lab2_fig16.png - Figure 4: Service status of both firewalls.)
(Image:Ops705_lab2_fig4.png - Figure 5: Default iptables firewall rules.)</p><p>The default firewall for CentOS, <em>firewalld</em> is more complex than we need. We&#x27;ll be reverting to the easier to use <em>iptables</em> standard. This will require the removal of the <em>firewalld</em> package, the installation of the <em>iptables-services</em> package, and working with systemd services to turn on your new firewall.</p><p><strong>Make sure you follow these instructions in order. If you don&#x27;t, you may be locked out of your Linux VM forever.</strong> If you encounter errors on any step, stop and ask for help. Do not continue!</p><p>As we are going to run several admin-level commands, we will log in as root for this section:</p><ol><li><p>From your regular user, elevate to the root account:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">su</span><span class="token plain"> -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Install the <em>iptables-services</em> firewall package:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yum </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> iptables-services</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Stop the <em>firewalld</em> service and start the <em>iptables</em> service in a single, chained command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl stop firewalld</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> systemctl start iptables</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Check the status of the <em>firewalld</em> service. It should tell you it&#x27;s stopped:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status -l firewalld</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Check the status of the <em>iptables</em> service. It should tell you it&#x27;s <strong>active</strong>: </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status -l iptables</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>View your current <em>iptables</em> firewall rules:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -L -vn --line-numbers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Refer to <em>Figure 5</em>. If your rules at this stage look different, stop and contact your professor for help. (Values in the <strong>pkts</strong> and <strong>bytes</strong> column may vary.)</p></li><li><p>Set the <em>iptables</em> firewall to start with the system:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> iptables</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Remove <em>firewalld</em> completely, including all unused files:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yum autoremove firewalld</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><ul><li>(<strong>Note:</strong> If you don&#x27;t remove <em>firewalld</em> and both firewalls are set to start with the system, <em>firewalld</em> will always start instead of iptables. This can lead to much frustration. Make sure you remove it!)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-2-securing-your-firewall">Part 2: Securing Your Firewall<a class="hash-link" href="#part-2-securing-your-firewall" title="Direct link to heading">​</a></h3><p>There are a few standard security practices to follow when dealing with firewalls. In this section, we will changes our firewall rules to follow those practices. For more detail, refer to the Week 2 lecture and material.</p><p>(Image:Ops705_lab2_fig15.png - Figure 6: Modified iptables firewall rules.)</p><ol><li><p>Set your default policy for the INPUT chain to DROP:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -P INPUT DROP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Remove the reject rule from the INPUT chain to hide our server from scans:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -D INPUT </span><span class="token number" style="color:#36acaa">5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Set your default policy for the FORWARD chain to DROP:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -P FORWARD DROP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Remove the reject rule from the FORWARD chain to hide it from scans:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -D FORWARD </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Verify your changes by running the list rules command again (Refer to <em>Fig. 6</em> as a reference):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iptables -nvL --line</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>To confirm you haven&#x27;t locked yourself out, log out of SSH and log back in. If you don&#x27;t encounter any login issues, you&#x27;re good to go.</p></li><li><p><strong>Assuming the step above works</strong>, in your Linux VM, save your rule changes:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">service</span><span class="token plain"> iptables save</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Congratulations, you&#x27;ve secured your firewall!</p></li><li><p>Drop back down to your regular user at this point, you never want to stay logged in as root: <code>exit</code></p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-3-securing-ssh">Investigation 3: Securing SSH<a class="hash-link" href="#investigation-3-securing-ssh" title="Direct link to heading">​</a></h2><p>In this investigation, you will be editing configuration text files to change the port the SSH service listens on. You will be using the <strong>vim</strong> utility to make some of these changes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-1-text-editing-with-vim">Part 1: Text Editing with <code>vim</code><a class="hash-link" href="#part-1-text-editing-with-vim" title="Direct link to heading">​</a></h3><p>(Image:vi-text-editor-2.png - Figure 7: The online vi-tutorial provides users &quot;hands-on&quot; experience of using the vi text editor.)</p><p>You will now learn basic editing skills using the vi (vim) text editor including creating, editing, and saving text files. As mentioned, the vim text editor (although taking longer to learn) has outstanding features to increase coding productivity.</p><p>(<code>vim</code> is a newer version of vi with expanded features. We will be using vim in this course. In most cases, <em>vi</em> and <em>vim</em> can be used interchangeably here.)</p><p>The big thing to remember with vim is that it starts in <strong>COMMAND</strong> mode. You need to issue letter commands to change modes (including to enter plain text into the document). Also, you can press colon “: ” in COMMAND mode to enter more complex commands.</p><p><strong>Resource:</strong> <a href="https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/04650c56-ae63-4c1c-8f3c-0cb5f38ebb6b/vi-help-sheet-011.pdf" target="_blank" rel="noopener noreferrer">vi Cheat Sheet (PDF)</a></p><p>An interactive tutorial has been created to give you &quot;hands-on&quot; experience on how to use vi text editor. It is recommended that you run this interactive tutorial in your Linux account to learn how to create and edit text files with the vi text editor.</p><ol><li><p>Run the interactive tutorial from your CentOS command line:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vi-tutorial</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>In the tutorial menu, select the first menu item labelled &quot;USING THE VI TEXT EDITOR&quot;</p></li><li><p>Read and follow the instructions in the tutorial. Eventually, it will display a simulated vi environment and will provide you with &quot;hands-on&quot; practice using the vi text editor.</p></li><li><p>When you have completed that section, you will be returned to the main menu.</p></li><li><p>If you want to get extra practice, you can select the menu item labelled &quot;REVIEW EXERCISE&quot;.</p></li><li><p>When you want to exit the tutorial, select the menu option to exit the tutorial.</p></li></ol><p>(Image:vi-text-editor-b.png - Figure 8: Contents of <em>othertext.txt</em>)</p><p>After you have completed the tutorial:</p><ol><li><p>Using <code>vim</code>, create a new text file called <em>othertext.txt</em> in your home directory with these two commands one at a time:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> ~</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">vim</span><span class="token plain"> othertext.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Write the text shown in <em>Figure 8</em> to your new <em>othertext.txt</em> file, save, and quit.</p></li><li><p>Confirm the contents of your text file match <em>Figure 8</em>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> othertext.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><p>You can also <strong>manage</strong>, <strong>view</strong> or <strong>manipulate the display</strong> of text files. This is HIGHLY ADVISED in case you only want to view contents and <strong>NOT</strong> edit text file contents which can cause accidental erasure of data.</p><p>Refer to the following table of Text File Management Commands:</p><table><thead><tr><th>Linux Command</th><th>Purpose</th><th>Example</th></tr></thead><tbody><tr><td>touch</td><td>Create empty file(s) / Updates Existing File&#x27;s Date/Time Stamp</td><td><code>touch otherfile.txt</code></td></tr><tr><td>cat</td><td>Display text file&#x27;s contents without editing (small files)</td><td><code>cat otherfile.txt</code></td></tr><tr><td>more, less</td><td>Display / Navigate within large text files without editing</td><td><code>less otherfile.txt</code></td></tr><tr><td>cp</td><td>Copy text file(s)</td><td><code>cp otherfile.txt uli101xx/otherfile.txt</code></td></tr><tr><td>mv</td><td>Move / Rename text files</td><td><code>mv otherfile.txt uli101xx/otherfile.txt</code></td></tr><tr><td>rm</td><td>Remove text file(s)</td><td><code>rm otherfile.txt</code></td></tr><tr><td>sort</td><td>Sorts (rearranges) order of file contents when displayed. Content is sorted alphabetically by default. The -n option sorts numerically, -r performs a reverse sort</td><td><code>sort otherfile.txt</code></td></tr><tr><td>head</td><td>Displays the <strong>first</strong> 10 lines of a text file by default. An option using a number value will display that number of lines (e.g. <code>head -5 filename</code> will display first 5 lines).</td><td><code>head -2 otherfile.txt</code></td></tr><tr><td>tail</td><td>Displays the <strong>last</strong> 10 lines of a text file by default. An option using a number value will display that number of lines (e.g. <code>tail -5 filename</code> will display last 5 lines).</td><td><code>tail -2 otherfile.txt</code></td></tr><tr><td>grep</td><td>Displays file contents that match a pattern</td><td><code>grep &quot;third&quot; otherfile.txt</code></td></tr><tr><td>uniq</td><td>Displays identical consecutive lines only once</td><td><code>uniq otherfile.txt</code></td></tr><tr><td>diff file1 file2</td><td>Displays differences between 2 files</td><td><code>diff otherfile.txt otherfile2.txt</code></td></tr><tr><td>file</td><td>Gives info about the contents of the file (e.g. file with no extension).</td><td><code>file othertext.txt</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-2-adding-a-custom-port-to-selinux">Part 2: Adding a Custom Port to SELinux<a class="hash-link" href="#part-2-adding-a-custom-port-to-selinux" title="Direct link to heading">​</a></h3><p><strong>SELinux</strong> is an extra security system that looks for unusual patterns of behaviour in programs. While SELinux is a large topic of its own, we will only work with it briefly here. In this part, we will tell SELinux it&#x27;s alright for it to allow SSH connections on a custom port.</p><p>The default is port <strong>22</strong>, we will be changing it to <strong>22222</strong>.</p><ol><li><p>Run the following command (it will several seconds to complete):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> semanage port -a -t ssh_port_t -p tcp </span><span class="token number" style="color:#36acaa">22222</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-3-adding-a-firewall-rule-for-the-custom-ssh-port">Part 3: Adding a Firewall Rule for the Custom SSH Port<a class="hash-link" href="#part-3-adding-a-firewall-rule-for-the-custom-ssh-port" title="Direct link to heading">​</a></h3><p>(Image:Ops705_sshd_custom_rule.png - Figure 9: Adding a firewall rule for our new SSH custom port.)</p><p>As mentioned, we want to change what port the system uses to allow incoming SSH connections. To do that, we have to add an extra rule to our firewall to allow it through:</p><ol><li><p>Review your current rules for reference:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> iptables -nvL --line</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Add a new rule to our firewall for port 22222: </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> iptables -A INPUT -p tcp --dport </span><span class="token number" style="color:#36acaa">22222</span><span class="token plain"> -j ACCEPT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Confirm your new rule has been added: </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> iptables -nvL --line</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>If it has, save your new rules: </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> iptables save</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-4-modifying-the-ssh-service-listen-port">Part 4: Modifying the SSH Service Listen Port<a class="hash-link" href="#part-4-modifying-the-ssh-service-listen-port" title="Direct link to heading">​</a></h3><p>(Admon/caution - WARNING: Failure to follow the steps in Part 4 <em>properly and carefully</em> will result in losing access to your Linux VM.|If that happens, you’ll need to delete the VM and recreate it.)</p><p>In this section, you will change what port the SSH service listens on for new connections.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-two-terminal-system">The Two-Terminal System<a class="hash-link" href="#the-two-terminal-system" title="Direct link to heading">​</a></h4><p>When working with cloud-based systems, your remote connection to the system must be protected at all costs. If you make a change that removes your ability to connect, this is usually <strong>permanent</strong>. This includes anything that changes your network, firewall, and SSH service. Careless modifications can result in a total loss of access. In these cases, the only way to recover is to delete the entire VM and start from scratch.</p><p>Luckily, most of these fatal mistakes only affect <em>new</em> remote connections. While you&#x27;re still connected you can still fix your mistakes.</p><p>Whenever you are modifying any of these (as you will below), you should use the Two-Terminal System. This involves opening two separate remote SSH terminals to your Linux system:</p><ol><li><strong>Control Terminal</strong>: This is the terminal you use to make changes to the system. <em>Do not log out of this terminal.</em></li><li><strong>Testing Terminal</strong>: This is the terminal you use to test your ability to reconnect after you make a change. Log out and log back in. If you&#x27;re unable to log back in, you&#x27;ve broken something. Use your Control Terminal to find the problem and fix it. Continue using your Testing Terminal to log back in as you fix problems and make changes.</li></ol><p>Make sure to follow this method during <em>Investigation 2</em> and <em>Investigation 3</em>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-listen-port">SSH Listen Port<a class="hash-link" href="#ssh-listen-port" title="Direct link to heading">​</a></h4><p>(Image:Ops705_sshd_listenport_custom.png - Figure 10: Setting the custom listen port for SSHd.)</p><ol><li><p>Using vim, open the SSH configuration file:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vim</span><span class="token plain"> /etc/ssh/sshd_config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Find the line (near the top) containing the words: <code>Port 22</code></p></li><li><p>Change this line to read: <code>Port 22222</code></p></li><li><p>Save and quit vim.</p></li><li><p>Restart the sshd service:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> systemctl restart sshd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Check the status of the service:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status -l sshd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>WARNING: If the status is in a <em>Failed</em> state, retrace your steps.</strong></p><ul><li>Look back at the SSHd config file for typos.</li><li>Did you forget to run the <code>semanage</code> command from Investigation 3, Part 2?</li></ul><p>Restart the SSHd service to apply additional changes <strong>and check its status again.</strong></p></li><li><p>If the status is <strong>active (running)</strong>, move onto the next step.</p></li><li><p>In your <strong>test terminal</strong>, disconnect from your SSH connection and reconnect <strong>using the new port 22222</strong>. </p><p>Example:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"> -p </span><span class="token number" style="color:#36acaa">22222</span><span class="token plain"> yourSenecaUsername@address</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>If you&#x27;re able to reconnect, move on to the next step.</p><p><strong>WARNING: If you can&#x27;t reconnect, use your control terminal window to find any mistakes you may have made.</strong></p><p><strong><em>Remember, don&#x27;t disconnect from your control terminal until you&#x27;re sure you can reconnect!</em> Use as many test terminal windows as you need.</strong></p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-5-using-ssh-keypairs">Part 5: Using SSH Keypairs<a class="hash-link" href="#part-5-using-ssh-keypairs" title="Direct link to heading">​</a></h3><p>(Admon/caution - WARNING: Failure to follow the steps in Part 5 <em>properly and carefully</em> will result in losing access to your Linux VM.|If that happens, you’ll need to delete the VM and recreate it.)</p><p>In Part 5, you will generate an SSH keypair on your Linux VM, install them, and then copy your keys onto your personal computer to allow you to authenticate to your VM securely going forward when connecting.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="switching-to-ssh-keypair-authentication">Switching to SSH keypair authentication:<a class="hash-link" href="#switching-to-ssh-keypair-authentication" title="Direct link to heading">​</a></h4><p>(Image:Ops705_filezilla-connect.png - Figure 11: Connection information for FileZilla using the custom port.)</p><ol><li><p>First, download and install the FileZilla Client software on your personal computer.</p></li><li><p>On your Linux VM as a regular user, generate your SSH keypair (accept all defaults):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Install the new keys on the system: </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-copy-id -p </span><span class="token number" style="color:#36acaa">22222</span><span class="token plain"> localhost</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Using FileZilla on your <strong>personal computer</strong>, log into the Linux VM and find your new public and private keys. They can be found on your Linux VM here:  </p><ul><li><p><strong>Private Key</strong>: <code>~/.ssh/id_rsa</code></p></li><li><p><strong>Public Key</strong>: <code>~/.ssh/id_rsa.pub</code></p></li></ul></li><li><p>Download these keys to your personal computer with FileZilla:</p><ul><li><p><strong>On Windows</strong>, store the downloaded key here: <code>C:\Users\[youruser]\.ssh\</code></p></li><li><p><strong>On macOS</strong>, store the downloaded key here: <code>~/.ssh/</code>, then run the following commands in macOS Terminal:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">700</span><span class="token plain"> ~/.ssh</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> ~/.ssh/id_rsa</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>With a second terminal, verify that you can login to your VM&#x27;s SSH from your personal computer without a password (keypair authentication). Do not move on to the next step until you’re sure.</p><ul><li>Login the same way as before. <strong>If you aren&#x27;t asked for a password, then keypair authentication has succeeded.</strong></li></ul></li><li><p>Save both keys (<code>id_rsa</code> and <code>id_rsa.pub</code>) to secondary, portable location. This can be online storage like OneDrive or Dropbox, or to a USB drive. You will need your keys when you come to class to log in to your Linux VM going forward.</p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="adding-your-professors-public-key">Adding Your Professor&#x27;s Public Key<a class="hash-link" href="#adding-your-professors-public-key" title="Direct link to heading">​</a></h4><p>In this section, you will add your professor&#x27;s public key to allow them to log in to your Linux VM and run lab checks and perform troubleshooting when needed.</p><ol><li><p>Confirm you have the file:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> ~/bin/professorID.pub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Using the following command as your <strong>regular user</strong>, install your professor&#x27;s public key on to your Linux VM:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> ~/bin/professorID.pub </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> ~/.ssh/authorized_keys</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>On your test terminal, log out and log back in again to check that keypair authentication is still working. If it isn&#x27;t, backtrack your steps and fix the issue!</p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-ssh-password-authentication">Disabling SSH password authentication:<a class="hash-link" href="#disabling-ssh-password-authentication" title="Direct link to heading">​</a></h4><p>(Image:Ops705_sshd_passauth_no.png - Figure 12: Disabling password-based authentication in SSHd.)</p><ol><li><p>Make sure you have two SSH separate terminals connected to you Azure Linux VM.</p></li><li><p>In your control terminal, use <code>vim</code> to open the SSH configuration file:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vim</span><span class="token plain"> /etc/ssh/sshd_config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Find the line that contains <em>PasswordAuthentication</em>, remove the # symbol at the beginning of the line, and change the yes into a <strong>no</strong>. It should look like this:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PasswordAuthentication no</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Save and quit vim.</p></li><li><p>Restart the sshd service:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> systemctl restart sshd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Check the status of the service:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status -l sshd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><strong>If the status is in a <em>Failed</em> state, retrace your steps.</strong> Look back at the SSHd config file for typos. Redo the last two steps to apply additional changes.</p></li><li><p>If the status is <strong>active (running)</strong>, move onto the next step.</p></li></ul></li><li><p>In your <strong>test terminal</strong>, disconnect from your SSH connection and reconnect.</p><ul><li><p>If you can to reconnect, move on to the next step.</p></li><li><p><strong>If you <em>can&#x27;t</em> reconnect, use your control terminal window to find any mistakes you may have made.</strong> Remember, don&#x27;t disconnect from your control terminal until you&#x27;re sure you can reconnect! Use as many test terminal windows as you need.</p></li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-4-confirming-your-linux-work">Investigation 4: Confirming Your Linux Work<a class="hash-link" href="#investigation-4-confirming-your-linux-work" title="Direct link to heading">​</a></h2><p>(Image:script-check-lab2.png - If all checks pass, then user performed task correctly and can continue.)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-a-shell-script-to-check-your-work">Running a Shell Script to Check Your Work<a class="hash-link" href="#running-a-shell-script-to-check-your-work" title="Direct link to heading">​</a></h3><p>Although you have been double-checking your work (right?), you <em>might</em> have made some mistakes.</p><p>For example:</p><ul><li>Forgetting to enable <code>iptables</code>.</li><li>Missing a firewall rule.</li><li>Forgetting to update Linux.</li></ul><p>To check for mistakes, a <strong>shell script</strong> has been created to check your work for you. </p><p><strong>If the checking shell script detects an error</strong>, then it will tell you and offer constructive feedback on how to fix that problem so you can re-run the checking shell scripts until your work is correct.</p><p>Perform the following steps:</p><ol><li>Change directories to ~/bin: <code>cd ~/bin</code></li><li>Make sure you have the most recent lab files: <code>git pull</code></li><li>Change back to your home directory: <code>cd ~</code></li><li>Run the checking script for your Linux work in this lab: <code>labcheck2.sh</code></li><li><strong>If you encounter errors:</strong><ul><li>Review the feedback.</li><li>Make the necessary corrections.</li><li>Re-run the checking script.</li></ul></li><li>If all checks pass (with the congratulations message), take a screenshot of the <strong>full script output</strong> (don&#x27;t leave any text out or cut off). You&#x27;ll need it for later.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="investigation-5-updating-windows-server-2019">Investigation 5: Updating Windows Server 2019<a class="hash-link" href="#investigation-5-updating-windows-server-2019" title="Direct link to heading">​</a></h2><p>Updating your Windows Server VM in Azure is a little bit easier. It takes advantage of the cloud infrastructure to allow point-and-click updates.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-1-updating-windows-with-artifacts">Part 1: Updating Windows with Artifacts<a class="hash-link" href="#part-1-updating-windows-with-artifacts" title="Direct link to heading">​</a></h3><p>(Image:Ops705_artifacts1.jpg - Figure 13: Adding artifacts to your Windows VM in Azure.)</p><ol><li>Spin up your Windows Server VM, and wait until it&#x27;s fully started up.</li><li>In the Azure blade for your Windows Server VM, click on the <strong>Manage artifacts</strong> item in the menu bar to the left.</li><li>In this new window, click on the <strong>Apply artifacts</strong> button. This will bring you to the <em>Add artifacts</em> screen.</li><li>In the <em>Add artifacts</em> search field, type <strong>Time</strong>.</li><li>Click on <strong>Set Time Zone</strong> in the results listing, then click <strong>Add</strong> in the next window.</li><li>You&#x27;ll be returned to the <em>Add artifacts</em> window.</li><li>Add the following additional artifacts:<ol><li>Firefox</li><li>Windows Firewall operations – Enable ICMP (Ping)</li><li>Installs the latest Windows Updates</li></ol></li><li>You&#x27;ll be returned to the <em>Add artifacts</em> window. Simply click <strong>OK</strong> to install them.</li><li>The <em>Manage Artifacts</em> window will return, and a new entry for each artifact will appear. Their statuses will cycle through <em>Pending</em>, <em>Installing</em>, and finally <em>Succeeded</em>.</li><li>When all artifacts are in a <em>Succeeded</em> state, move to Part 2. (This may take 10-20 minutes.)</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-submission">Lab Submission<a class="hash-link" href="#lab-submission" title="Direct link to heading">​</a></h2><p>Submit to Blackboard <strong>full-desktop</strong> screenshots (PNG/JPG) of the following:</p><ol><li>Results of a successful run of <code>labcheck2.sh</code>.</li><li>Logging in to your Linux VM without a password on port <strong>22222</strong>.</li><li>Run the <code>yum update</code> command to show there are no further updates to install and screenshot the result.</li><li>Service status of <em>firewalld</em> and <em>iptables</em>.</li><li>Listing of your modified firewall rules.</li><li>A full view of the contents of your <strong>othertext.txt</strong> file.</li><li>A full view of the contents of <strong>~/.ssh/authorized_keys</strong>.</li><li>Listing of your applied artifacts in Azure for your Windows Server VM.</li></ol><p><strong>Reminder:</strong> Make sure to fully stop your VMs when you&#x27;re done!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seneca-ICTOER/OPS705/tree/main/docs/Labs/lab2.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/OPS705/Labs/lab1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 1</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/OPS705/Labs/lab3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 3</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#lab-preparation" class="table-of-contents__link toc-highlight">Lab Preparation</a><ul><li><a href="#purpose--objectives-of-lab-2" class="table-of-contents__link toc-highlight">Purpose / Objectives of Lab 2</a></li><li><a href="#minimum-requirements" class="table-of-contents__link toc-highlight">Minimum Requirements</a></li></ul></li><li><a href="#key-concepts" class="table-of-contents__link toc-highlight">Key Concepts</a><ul><li><a href="#security-from-the-beginning" class="table-of-contents__link toc-highlight">Security: From the Beginning</a></li><li><a href="#firewalls" class="table-of-contents__link toc-highlight">Firewalls</a></li><li><a href="#ssh-keypair-authentication" class="table-of-contents__link toc-highlight">SSH Keypair Authentication</a></li><li><a href="#editing-text-files" class="table-of-contents__link toc-highlight">Editing Text Files</a></li></ul></li><li><a href="#investigation-1--update-linux" class="table-of-contents__link toc-highlight">Investigation 1:  Update Linux</a><ul><li><a href="#part-1-privilege-escalation" class="table-of-contents__link toc-highlight">Part 1: Privilege Escalation</a><ul><li><a href="#using-sudo" class="table-of-contents__link toc-highlight">Using Sudo</a></li></ul></li><li><a href="#part-2-update-centos" class="table-of-contents__link toc-highlight">Part 2: Update CentOS</a></li></ul></li><li><a href="#investigation-2-configuring-your-firewall" class="table-of-contents__link toc-highlight">Investigation 2: Configuring Your Firewall</a><ul><li><a href="#part-1-replacing-firewalld-with-iptables" class="table-of-contents__link toc-highlight">Part 1: Replacing <em>firewalld</em> with <em>iptables</em></a></li><li><a href="#part-2-securing-your-firewall" class="table-of-contents__link toc-highlight">Part 2: Securing Your Firewall</a></li></ul></li><li><a href="#investigation-3-securing-ssh" class="table-of-contents__link toc-highlight">Investigation 3: Securing SSH</a><ul><li><a href="#part-1-text-editing-with-vim" class="table-of-contents__link toc-highlight">Part 1: Text Editing with <code>vim</code></a></li><li><a href="#part-2-adding-a-custom-port-to-selinux" class="table-of-contents__link toc-highlight">Part 2: Adding a Custom Port to SELinux</a></li><li><a href="#part-3-adding-a-firewall-rule-for-the-custom-ssh-port" class="table-of-contents__link toc-highlight">Part 3: Adding a Firewall Rule for the Custom SSH Port</a></li><li><a href="#part-4-modifying-the-ssh-service-listen-port" class="table-of-contents__link toc-highlight">Part 4: Modifying the SSH Service Listen Port</a><ul><li><a href="#the-two-terminal-system" class="table-of-contents__link toc-highlight">The Two-Terminal System</a></li><li><a href="#ssh-listen-port" class="table-of-contents__link toc-highlight">SSH Listen Port</a></li></ul></li><li><a href="#part-5-using-ssh-keypairs" class="table-of-contents__link toc-highlight">Part 5: Using SSH Keypairs</a><ul><li><a href="#switching-to-ssh-keypair-authentication" class="table-of-contents__link toc-highlight">Switching to SSH keypair authentication:</a></li><li><a href="#adding-your-professors-public-key" class="table-of-contents__link toc-highlight">Adding Your Professor&#39;s Public Key</a></li><li><a href="#disabling-ssh-password-authentication" class="table-of-contents__link toc-highlight">Disabling SSH password authentication:</a></li></ul></li></ul></li><li><a href="#investigation-4-confirming-your-linux-work" class="table-of-contents__link toc-highlight">Investigation 4: Confirming Your Linux Work</a><ul><li><a href="#running-a-shell-script-to-check-your-work" class="table-of-contents__link toc-highlight">Running a Shell Script to Check Your Work</a></li></ul></li><li><a href="#investigation-5-updating-windows-server-2019" class="table-of-contents__link toc-highlight">Investigation 5: Updating Windows Server 2019</a><ul><li><a href="#part-1-updating-windows-with-artifacts" class="table-of-contents__link toc-highlight">Part 1: Updating Windows with Artifacts</a></li></ul></li><li><a href="#lab-submission" class="table-of-contents__link toc-highlight">Lab Submission</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">OPS705 - Introduction to Cloud Computing</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/OPS705/">Contents</a></li><li class="footer__item"><a href="#" id="pwa-button" class="footer__link-item" hidden>Install as an App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Seneca College.</div></div></div></footer></div>
<script src="/OPS705/assets/js/runtime~main.bfe77d86.js"></script>
<script src="/OPS705/assets/js/main.df20ef37.js"></script>
</body>
</html>